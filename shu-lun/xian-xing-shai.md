# 线性筛

## 原理

 每个合数必有一个最大因子（不包括它本身） ，用这个因子把合数筛掉

先假设一个数i，一个合数t，i是t最大的因数，t显然可能并不唯一（例如30和45的最大因数都是15）。那么如何通过i知道t呢，t必然等于i乘以一个比i小的素数。先来说这个数为什么一定要比i小，这很显然，如果是i乘上一个比它大的素数，那么i显然不能是t最大的因子。再来说为什么要是素数，因为如果乘上一个合数，我们知道合数一定可以被分解成几个素数相乘的结果，如果乘上的这个合数x=p1\*p2\*……，那么t = i \* x = i \* p1 \* p2……很显然p1\* i也是一个因数，而且大于i。所以必须乘上一个素数。

比i小的素数一定有不少，那么该乘哪一个呢，既然t不唯一，那么是不是都乘一遍呢？很显然不行，虽然t不唯一，但全乘一遍很显然筛掉的数的数量远远超过合数的数量。我们先给出结论：

任意一个数i = p1\*p2\*……\*pn，p1、p2、……pn都是素数，p1是其中最小的素数，

设T 为i \* M的积（显然T就成了一个合数），也就是T = i \* M，（M是素数，并且M&lt;=p1）,那么T的最大的因数就是i。 乘上的数要小于等于i最小的质因数。

